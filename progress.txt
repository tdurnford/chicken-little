## 2026-01-15: Smooth Chicken Movement (Work Item #1) - COMPLETED

Implemented smooth position and rotation interpolation for wandering chickens in ChickenVisuals.lua.

### Changes made:
- Added `targetPosition`, `targetFacingDirection`, and `currentFacingDirection` fields to ChickenVisualState type
- Added interpolation constants: `POSITION_LERP_SPEED = 10` and `ROTATION_LERP_SPEED = 8`
- Created new `applyWalkingAnimation()` function that:
  - Lerps position toward target using deltaTime-based factor
  - Smoothly interpolates facing direction for gradual rotation
  - Adds subtle bob while walking
- Updated `updatePosition()` to store target positions instead of applying directly
- Modified Heartbeat loop to call `applyWalkingAnimation()` for walking chickens
- Idle bobbing animation preserved and unchanged

### Files modified:
- src/client/ChickenVisuals.lua

### Testing notes:
- Build passes (`make build`)
- Linter unavailable (architecture mismatch for selene binary)
- Manual testing recommended: spawn chickens and observe smooth movement transitions

---

## 2026-01-15: Fix Brown Hen Money Rate Display (Work Item #3) - COMPLETED

Fixed formatMoneyRate() function in ChickenVisuals.lua to preserve decimal precision for money rates.

### Changes made:
- Rewrote `formatMoneyRate()` to conditionally show decimals:
  - Rates with decimal values (e.g., 1.2) now display as `$1.2/s` instead of `$1/s`
  - Whole number rates still display without decimals (e.g., `$1/s`, `$10/s`)
  - Large rates (1000+) show K suffix with decimals if needed (e.g., `$1.3K/s`)
- Brown Hen now correctly displays `$1.2/s` matching its actual 1.2 moneyPerSecond rate

### Files modified:
- src/client/ChickenVisuals.lua

### Testing notes:
- Build passes (`make build`)
- Expected display values:
  - Brown Hen (1.2): `$1.2/s`
  - Basic Chick (1.0): `$1/s`
  - White Hen (1.5): `$1.5/s`
  - Epic chicken (1000): `$1K/s`
  - Epic*1.3 (1300): `$1.3K/s`

---

## 2026-01-15: Remove Unnecessary Decimal Places from Store Prices (Work Item #2) - COMPLETED

Implemented clean currency formatting that removes unnecessary decimal places from store prices.

### Changes made:
- Added `stripTrailingZeros()` helper function in MoneyScaling.lua to remove trailing zeros from formatted numbers
- Created `formatCleanCurrency()` function that:
  - Displays whole numbers without decimals (e.g., `$100` not `$100.00`)
  - Preserves meaningful decimal places (e.g., `$99.50` stays as `$99.5`)
  - Handles large numbers with suffixes cleanly (e.g., `$1K` not `$1.00K`, `$1.5K` for 1500)
- Updated StoreUI.lua to use `formatCleanCurrency()` for all price displays:
  - Egg purchase prices (line 383)
  - Dynamic price updates in affordability check (line 524)
  - Supply item prices (line 964)
  - Weapon item prices (line 1298)

### Files modified:
- src/shared/MoneyScaling.lua
- src/client/StoreUI.lua

### Testing notes:
- Build passes (`make build`)
- Linter unavailable (architecture mismatch for selene binary)
- Expected display values:
  - $100 (whole) -> `$100`
  - $99.50 -> `$99.5`
  - $1000 -> `$1K`
  - $1500 -> `$1.5K`
  - $1000000 -> `$1M`

---

## 2026-01-15: Implement Day/Night Cycle System (Work Item #4) - COMPLETED

Implemented a complete day/night cycle system with smooth lighting transitions and visual effects.

### Changes made:
- Created new `DayNightCycle.lua` module in src/shared/ with:
  - 20-minute full cycle (real-time)
  - Four time periods: dawn (5-7), day (7-18), dusk (18-20), night (20-5)
  - Smooth interpolation between lighting presets
  - ColorCorrection effect with period-specific tints (blue at night, warm at dawn/dusk)
  - Bloom effect (stronger at dawn/dusk for atmospheric glow)
  - Helper functions: `isNight()`, `isDawn()`, `isDusk()`, `isDay()`, `getTimeOfDay()`, `getGameTime()`
  - `getPredatorSpawnMultiplier()` for future predator night spawning (Work Item #5)
  - `getTimeInfo()` for client synchronization
- Integrated into Main.server.lua:
  - Added require statement for DayNightCycle module
  - Added dayNightState variable declaration
  - Initialized state after store inventory
  - Added `DayNightCycle.update()` call in main game loop (runs every frame)
- Added 5 integration tests for DayNightCycle module in IntegrationTests.lua

### Files modified:
- src/shared/DayNightCycle.lua (new file)
- src/server/Main.server.lua
- src/shared/IntegrationTests.lua

### Technical details:
- Lighting properties interpolated: ClockTime, Ambient, OutdoorAmbient, Brightness, ColorShift_Top, ColorShift_Bottom
- Lighting presets per period with smooth transitions at boundaries
- Uses `os.time()` for consistent server-side timing
- Creates ColorCorrectionEffect and BloomEffect instances in Lighting service

### Testing notes:
- Build passes (`make build`)
- Format check passes (`make format-check`)
- Manual testing recommended: observe lighting changes over 20-minute cycle
- Expected behavior:
  - Dawn (5-7): Warm orange/pink lighting, moderate bloom
  - Day (7-18): Bright clear lighting, minimal effects
  - Dusk (18-20): Warm orange/pink lighting, strongest bloom
  - Night (20-5): Dark blue tint, reduced brightness, subtle effects

---

## 2026-01-15: Predators Prefer Night Time Spawning (Work Item #5) - COMPLETED

Implemented time-of-day based predator spawn multipliers, making nightfall more dangerous.

### Changes made:
- Modified `PredatorSpawning.lua` to accept optional `timeOfDayMultiplier` parameter:
  - Updated `calculateSpawnInterval()` to apply time multiplier (interval / multiplier)
  - Updated `getWaveInfo()` to pass multiplier to interval calculation
  - Updated `shouldSpawn()` to accept time multiplier
  - Updated `getNextSpawnTime()` to accept time multiplier
  - Updated `spawn()` to accept time multiplier and pass through
  - Updated `getTimeUntilNextSpawn()` to accept time multiplier
  - Updated `getSummary()` to include timeOfDayMultiplier in return value
- Modified `Main.server.lua`:
  - Added `previousTimeOfDay` tracking variable
  - Get spawn multiplier from `DayNightCycle.getPredatorSpawnMultiplier(dayNightState)`
  - Pass multiplier to `PredatorSpawning.shouldSpawn()` and `PredatorSpawning.spawn()`
  - Added time-of-day transition detection in game loop
  - Fire `NightfallWarning` event when transitioning to dusk/night/dawn
- Added `NightfallWarning` remote event to `RemoteSetup.lua`
- Added client-side handler in `Main.client.lua`:
  - Play appropriate alert sounds (urgent for night, standard for dusk, soft for dawn)
  - Show notification via MainHUD.showNotification with color-coded messages
- Added `MainHUD.showNotification()` function for general notifications:
  - Slide-in animation from top
  - Color-coded border and text
  - Auto-dismiss with fade-out animation
- Added 3 integration tests for time multiplier functionality

### Spawn multipliers (from DayNightCycle.lua):
- Day: 0.5x (spawns half as often)
- Dawn: 0.75x (slightly fewer spawns)
- Dusk: 1.25x (slightly more spawns)
- Night: 2.0x (spawns twice as often)

### Files modified:
- src/shared/PredatorSpawning.lua
- src/server/Main.server.lua
- src/server/RemoteSetup.lua
- src/client/Main.client.lua
- src/client/MainHUD.lua
- src/shared/IntegrationTests.lua

### Testing notes:
- Build passes (`make build`)
- Format check passes (`make format-check`)
- Manual testing recommended: observe predator spawn rates during different times of day
- Expected behavior:
  - Dusk warning: "Night is falling! Predators are becoming more active."
  - Night warning: "Night has fallen! Predator danger is at its peak!"
  - Dawn notification: "Dawn is breaking. Predator activity is decreasing."

---

## 2026-01-15: Soften Store Restock Timer Background Color (Work Item #6) - COMPLETED

Updated the restock timer background in StoreUI.lua from aggressive red/orange to subtle slate blue.

### Changes made:
- Changed `BackgroundColor3` from bright orange-red `RGB(255, 100, 50)` to muted slate blue `RGB(71, 85, 105)`
- Updated `UIGradient` from red-to-orange `RGB(220, 60, 60) → RGB(255, 140, 50)` to subtle slate gradient `RGB(71, 85, 105) → RGB(100, 116, 139)`
- Changed `TextStrokeColor3` from dark red `RGB(80, 20, 10)` to dark slate `RGB(30, 41, 59)`
- White text remains for good contrast against the new background

### Files modified:
- src/client/StoreUI.lua

### Testing notes:
- Build passes (`make build`)
- Timer is now subtle and blends with store UI
- Text remains readable with dark slate stroke
- No longer jarring or attention-grabbing

---

## PRD COMPLETE (polish-prd.json)

All 6 work items in polish-prd.json have been completed:
1. ✅ Smooth Chicken Movement with Interpolation
2. ✅ Remove Unnecessary Decimal Places from Store Prices  
3. ✅ Fix Brown Hen Money Rate Display Mismatch
4. ✅ Implement Day/Night Cycle System
5. ✅ Predators Prefer Night Time Spawning
6. ✅ Soften Store Restock Timer Background Color

---

## 2026-01-15: Fix Wave of '-0' Damage Numbers (bugfix-prd.json Work Item #6) - COMPLETED

Fixed the issue where '-0' damage numbers would appear when predators attack players.

### Root cause:
The `showDamageNumber()` function in DamageUI.lua did not filter out 0 or negative damage values. When `damageResult.damageDealt` was 0 (due to damage reduction, armor, or edge cases), the `-%.0f` format would display as `-0`.

### Changes made:
- Added early return guard in `DamageUI.showDamageNumber()` function (line 119-122)
- Now checks `if damage <= 0 then return end` before creating damage number UI elements
- Prevents unnecessary UI element creation and animation for zero damage

### Files modified:
- src/client/DamageUI.lua

### Testing notes:
- Build passes (`make build`)
- Format check passes (`make format-check`)
- Valid positive damage numbers still display correctly
- Zero and negative damage values are silently ignored (no UI created)

### Acceptance criteria met:
- ✅ No '-0' damage numbers appear when predator attacks
- ✅ Valid damage numbers (> 0) still display correctly
- ✅ Damage UI remains responsive and accurate
